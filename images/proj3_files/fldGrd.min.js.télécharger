(function(t,e){if(typeof define==="function"&&define.amd){define("FldGrd",["module","exports"],e)}else if(typeof exports!=="undefined"){e(module,exports)}else{var i={exports:{}};e(i,i.exports);t.FldGrd=i.exports}})(this,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});var i={rowHeight:250,rowHeightOrphan:function t(e){return Math.round(e.heightAvg)},itemSelector:"*",objSelector:"img",dataWidth:"data-fld-width",dataHeight:"data-fld-height"};function s(t,e){var i=[];var s=null;var r=null;var n=null;s=e.split(",");if(!t.id){n="_temp_"+Math.random().toString(36).substr(2,10);t.setAttribute("id",n)}while(s.length){i.push("#"+t.id+" > "+s.pop())}r=document.querySelectorAll(i.join(", "));if(n){t.removeAttribute("id")}return r}function r(t){for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;s<e;s++){i[s-1]=arguments[s]}var r=Object(t);Object.keys(i).forEach(function(t){if(i[t]!==undefined&&i[t]!==null){Object.keys(i[t]).forEach(function(e){r[e]=i[t][e]})}});return r}var n=function t(e,s){if(!(e instanceof Element)){throw new Error("`el` is not an element")}this.el=e;this.items=[];this._props={gutter:null,pendingResize:false};this._bind={};this._settings=r({},i,s);this._init();return this};n.prototype={_init:function t(){this._setup();this._attachEventListeners();this.update()},_setup:function t(){var e=null;var i=null;var r=null;var n=null;var h=null;var a=0;e=s(this.el,this._settings.itemSelector);n=e.length;h=getComputedStyle(e[0],null);this._props.gutter+=parseInt(h.marginLeft,10)||0;this._props.gutter+=parseInt(h.marginRight,10)||0;this._props.gutter+=parseInt(h.paddingLeft,10)||0;this._props.gutter+=parseInt(h.paddingRight,10)||0;for(;a<n;a+=1){i=parseInt(e[a].getAttribute(this._settings.dataWidth),10);r=parseInt(e[a].getAttribute(this._settings.dataHeight),10);if(!isNaN(i)&&!isNaN(r)){this.items.push({width:i,normWidth:i*(this._settings.rowHeight/r),height:r,el:e[a].querySelector(this._settings.objSelector)})}}},update:function t(){var e=this.el.clientWidth;var i=this.items.length;var s=[];var r=0;var n=0;var h=0;var a=0;var o=0;var l=0;var d=0;var u=0;var p=false;var g=0;var f=0;for(;g<i;g+=1){n+=this.items[g].normWidth;a+=this._props.gutter;p=g===i-1;if(n+a>=e||p){h=e-a;if(h/n>1&&p){o=this._settings.rowHeightOrphan.call(this,{heightAvg:l/s.length,heights:s});d=o/this._settings.rowHeight}else{d=Math.min(h/n,1);o=Math.floor(d*this._settings.rowHeight)}s.push(o);l+=o;for(f=r;f<=g;f+=1){u=Math.floor(d*this.items[f].normWidth)-1;this.items[f].el.style.width=u+"px";this.items[f].el.style.height=o+"px"}n=0;a=0;r=g+1}}this._props.pendingResize=false;return this},_attachEventListeners:function t(){this._bind.resize=this._handleResize.bind(this);window.addEventListener("resize",this._bind.resize)},_handleResize:function t(){if(!this._props.pendingResize){this._props.pendingResize=true;window.requestAnimationFrame(this.update.bind(this))}},destroy:function t(){window.removeEventListener("resize",this._bind.resize);this.el=this.items=this._bind=this._settings=this._handlers=null}};e.default=n;t.exports=e["default"]});